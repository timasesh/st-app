{% extends 'courses/teacher_base.html' %}

{% block title %}Мой профиль{% endblock %}
{% block page_title %}Мой профиль{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-4">
        <div class="card">
            <div class="card-body text-center">
                {% if teacher.avatar %}
                    <img src="{{ teacher.avatar.url }}" alt="Avatar" class="rounded-circle mb-3" style="width: 150px; height: 150px; object-fit: cover;">
                {% else %}
                    <div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center mx-auto mb-3" style="width: 150px; height: 150px; font-size: 3rem;">
                        <i class="fas fa-chalkboard-teacher"></i>
                    </div>
                {% endif %}
                
                <h4>{{ teacher.full_name }}</h4>
                <p class="text-muted">{{ teacher.specialization|default:"Специализация не указана" }}</p>
                
                <div class="mt-3">
                    <span class="badge badge-success badge-pill">
                        <i class="fas fa-check-circle"></i> Активен
                    </span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h4 class="mb-0">
                    <i class="fas fa-user-edit mr-2"></i>
                    Информация о профиле
                </h4>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="font-weight-bold">Имя:</label>
                            <p>{{ teacher.first_name }}</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="font-weight-bold">Фамилия:</label>
                            <p>{{ teacher.last_name }}</p>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="font-weight-bold">Email:</label>
                            <p>{{ teacher.user.email }}</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="font-weight-bold">Телефон:</label>
                            <p>{{ teacher.phone_number|default:"Не указан" }}</p>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="font-weight-bold">Специализация:</label>
                    <p>{{ teacher.specialization|default:"Не указана" }}</p>
                </div>
                
                {% if teacher.bio %}
                    <div class="form-group">
                        <label class="font-weight-bold">О преподавателе:</label>
                        <p>{{ teacher.bio }}</p>
                    </div>
                {% endif %}
                
                <div class="form-group">
                    <label class="font-weight-bold">Дата регистрации:</label>
                    <p>{{ teacher.created_at|date:"d.m.Y H:i" }}</p>
                </div>
            </div>
        </div>
        
        <div class="card mt-4">
            <div class="card-header">
                <h4 class="mb-0">
                    <i class="fas fa-chart-bar mr-2"></i>
                    Статистика
                </h4>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 text-center">
                        <div class="stats-item">
                            <div class="stats-number text-primary">{{ teacher.courses.count }}</div>
                            <div class="stats-label">Курсов</div>
                        </div>
                    </div>
                    <div class="col-md-3 text-center">
                        <div class="stats-item">
                            <div class="stats-number text-success">
                                {% with total_modules=teacher.courses.all|length %}
                                    {% for course in teacher.courses.all %}
                                        {% with total_modules=total_modules|add:course.modules.count %}
                                        {% endwith %}
                                    {% endfor %}
                                    {{ total_modules }}
                                {% endwith %}
                            </div>
                            <div class="stats-label">Модулей</div>
                        </div>
                    </div>
                    <div class="col-md-3 text-center">
                        <div class="stats-item">
                            <div class="stats-number text-warning">
                                {% with total_lessons=0 %}
                                    {% for course in teacher.courses.all %}
                                        {% for module in course.modules.all %}
                                            {% with total_lessons=total_lessons|add:module.lessons.count %}
                                            {% endwith %}
                                        {% endfor %}
                                    {% endfor %}
                                    {{ total_lessons }}
                                {% endwith %}
                            </div>
                            <div class="stats-label">Уроков</div>
                        </div>
                    </div>
                    <div class="col-md-3 text-center">
                        <div class="stats-item">
                            <div class="stats-number text-info">
                                {% with total_students=0 %}
                                    {% for course in teacher.courses.all %}
                                        {% with total_students=total_students|add:course.students.count %}
                                        {% endwith %}
                                    {% endfor %}
                                    {{ total_students }}
                                {% endwith %}
                            </div>
                            <div class="stats-label">Студентов</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.stats-item {
    padding: 1rem;
}

.stats-number {
    font-size: 2rem;
    font-weight: bold;
    margin-bottom: 0.5rem;
}

.stats-label {
    color: #6c757d;
    font-size: 0.9rem;
}
</style>
{% endblock %}
